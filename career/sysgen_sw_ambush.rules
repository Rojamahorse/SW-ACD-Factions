Type = None
Conditions
{
	MinNodeTier = 4
}
SubSpawners
[
	{
		Type = Doodads
		Count = [1, 1]
		//Count = [6, 12]
		Distance = [0, 25000]
		Tags = [rare_asteroid, asteroid, megaroid]
		MinDistanceFromTags = [[sun, 7000], [station, 2000], [bounty, 2000], [asteroid_field, 800], [ftl_gate, 1200]]
		DoodadTypes
		[
			{ Type=SW.asteroid_doonium_l;  ChanceWeight=1; }
			{ Type=SW.asteroid_zersium_m;  ChanceWeight=1; }
			{ Type=cosmoteer.asteroid_iron_m;       ChanceWeight=1; }
			{ Type=cosmoteer.asteroid_carbon_m;     ChanceWeight=1; }
		]	
		SubSpawners = &~/SWGhostShipSubSpawnersHandler
	}
]
SWGhostShipSubSpawnersHandler
[
	// Defector Ships.
	{
		Type = Ships
		Tags = [swfighter]
		Count = [10, 15]
		Distance = [500, 800]
		MinDistanceFromTags = [[swfighter, 60],[Combat, 60],[asteroid, 60]]
		Allegiance = Unique
		SynchronizeAllegiance = true
		SpawnsPerSlice = 1
		SpawnSlicePadding = 15%
		RandomHealthRange = [100%, 100%]
		FamePerTier = &/TIER_TABLES/StandardFamePerTier
		MaxFamePerTier = &/TIER_TABLES/StandardMaxFamePerTier
		ShipCriteria
		{
			UseLocalFactionWeights = true
			UseTierField = true
			FleetTierRemapTable = &<./data/modes/career/fleet_tier_remap_table.rules>/FleetTierRemapTable
			AllowTierRangeExpansion = true
			UseEvenShipTypeDistribution = true
			Tags = [swfighter]
		}
		AI
		{
			Type = SWHitAndFadeAI
			PatrolRadius = 400
			TargetAcquireRangeFromOrigin = 900
			TargetUnacquireRangeFromOrigin = 1500
			StasisSpeed = 0
		}
	}
	{
		Type = None // Asteroid field and junk and POI
		Count = 1
		Tags = [asteroid_field, sw_defectors_field]
		Radius = 1500

		SubSpawners
		[
			// ambient asteroids
			{
				Type = Doodads
				Count = [1, 3]
				DoodadTypes = [cosmoteer.megaroid_l, cosmoteer.megaroid_xl]
				Tags = [asteroid]
				Distance = [1450, (&../../../Radius)]
				RootLocation = Grandparent
				AddDistance = ParentToGrandparent
				SpawnsPerSlice = 1
				SpawnSlicePadding = 35%
				MinDistanceFromTags = [[asteroid, 120][Combat, 100]]
				NameGenerator
				{
					Type = Multi
					SubGenerators
					[
						{
							Chance = .05
							Type = NameList
							Names
							[
								"Lost"
								"Forgotten"
								"Inconspicuous"
							]
						}
						{
							Chance = .75
							Type = NameList
							Names
							[
								"Derelict"
								"Destroyed"
								"Deteriorating"
								"Orbiting"
								"Dead"
								"Floating"
								"Hidden"
								"Ruined"
								"Crumbling"
								"Shadowy"
								"Darkened"
								"Undiscovered"		
							]
						}
						{
							Chance = 1
							Type = NameList
							Names
							[
								"Hive"
								"Hideout"
							]
						}
					]
				}
			}
			// Abandoned Ship
			{
				Tags = [misc_discoverable, abandoned_capitalship, abandoned]
				Count = [1]
				Distance = [500, (&../../../Radius)]
				MinDistanceFromTags
				[
					[misc_discoverable, 100]
					[asteroid, 50]
					[combat, 100]
				]
				SuppressLocationAssertions = true
				
				Type = Ships
				Allegiance = Junk
				InitToMax = false
				SpawnCrew = false
				RandomHealthRange = [25%, 100%]
				Labels = ["abandoned_capitalship"]
				ShipCriteria
				{
					UseLocalFactionWeights = true
					UseTierField = true
					Tier = +2
					AllowTierRangeExpansion = true
					Tags = [swcapital]
				}
			}
			{
				Type = Doodads
				Count = [30, 60]
				Distance = [500, (&../../../Radius)*1.1]
				Tags = [asteroid]
				RootLocation = Grandparent
				AddDistance = ParentToGrandparent
				//MinDistanceFromTags = [[station, 500], [asteroid, 50]]
				MinDistanceFromTags
				[
					[misc_discoverable, 20]
					[asteroid, 20]
					[combat, 100]
				]
				DoodadTypes = &<./data/modes/career/sectors/sysgen_asteroids.rules>/CommonAsteroidTypes
			}
			// Valuable asteroid.
			{
				Type = Doodads
				Tags = [rare_asteroid]
				RootLocation = Grandparent
				AddDistance = ParentToGrandparent
				Count = [2, 3]
				Distance = [600, (&../../../Radius)]
				MinDistanceFromTags
				[
					[misc_discoverable, 20]
					[asteroid, 20]
					[combat, 100]
				]
				DoodadTypes = &<./data/modes/career/sectors/sysgen_asteroids.rules>/RareAsteroidTypes
			}
			// POI
			{
				Type = Doodads
				DoodadType = sw.defectorsPOI
				ShowOnlyInFog = true
				Undiscovered = true
				HideIfUnexplored = true
				ScaleFactor = &../../Radius
				Tags = [asteroid_field_poi, poi_unknown, sw_defectors_field_poi]
				//AutoRemoveWhenTagDestroyed = defectors
			}
		]
	}
	// Mission to hunt defectors inside the ring
	{
		Type = Mission
		Metatype = SWAbandonedCapitalShipAmbush
		SpawnAt = Tag
		SpawnAtTag = { Mode=Nearest; Tag=trade_station; }
		Faction = OwnerOfTag
		FactionTag = &SpawnAtTag
		Objectives
		[
			{
				Type = Sequential
                SubObjectives
                [
                    {
                        Type = GoTo
                        Location = { Mode=Nearest; Tag=abandoned_capitalship; }
                        DisplayFormatKey = "Objectives/GoToAbandonedCaptialShip"
                    }
                    {
                        Type = DefeatShips
                        TargetsTag = { Tag=tie_fighter; }
                        DisplayFormatKey = "Objectives/DefeatAllSWFighters"
                        AllowSurrender = false
                    }
                    {
                        Type = ReceiveRewards
                        Location = { Mode=Nearest; Tag=trade_ship; }
                        DisplayFormatKey = "Objectives/ReturnToTradeShip"
                    }
                ]
			}
		]
		Rewards
		[
			{
				Type = Money
				MoneyPerHighTier = &/TIER_TABLES/StandardMoneyPerTier
				MoneyPerTierMultiplier = 4
				RoundToMultiple = 1000
			}
			{
				Type = Fame
				FamePerHighTier = &/TIER_TABLES/StandardFamePerTier
				FamePerTierMultiplier = 3
				MaxFamePerHighTier = &/TIER_TABLES/StandardMaxFamePerTier
			}
			{
				Type = Reputation
				ReputationPerHighTier = &/TIER_TABLES/StandardReputationPerTier
				ReputationPerTierMultiplier = 4
			}
		]
	}
]